<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pebble SDK: AppMessage</title>
  <link href='bootstrap.css' media='screen' rel='stylesheet' type='text/css' />
  <link href='pebble-developer.css' media='screen' rel='stylesheet' type='text/css' />
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
  <link href="stylesheet.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30638158-4']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>
<body>
  <div id="top" ><!-- do not remove this div, it is closed by doxygen! -->
    <div class="navbar navbar-inverse ">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a class="first" href="#"><span></span></a></li>
              <li><a href="http://developer.getpebble.com/">Develop for Pebble</a></li>
            </ul>
            <ul class="nav pull-right">
              <li class="doc-nav-searchbox">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</li>
              <li><a href="http://forums.getpebble.com/">Forum</a></li>
              <li><a href="http://developer.getpebble.com/sdkref/modules.html">API Documentation</a></li>
              <li><a href="http://developer.getpebble.com/1/">Guides</a></li>
              <li><a href="http://developer.getpebble.com/blog/">Developer Blog</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___app_message.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AppMessage<div class="ingroups"><a class="el" href="group___foundation.html">Foundation</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Bi-directional communication between phone apps and watch apps. </p>
<p>AppMessage is a messaging sybsystem that allows phone and watch applications to exchange arbitrary sets of key-value pairs. The key value pairs are stored in the form of a <a class="el" href="group___dictionary.html#struct_dictionary" title="Header data structure of a serialized &quot;dictionary&quot; of zero or more Tuple key-value pairs...">Dictionary</a>, the layout of which is left for the application developer to define.</p>
<h3>Key Points</h3>
<ul>
<li>AppMessage is bi-directional. Both phone and watch can initiate sending a message (no "client-server" model).</li>
<li>Messages always need to get ACKnowledged or NACK'ed, or else it will result in a time-out failure. The AppMessage subsystem takes care of this implicitly. In the phone libraries, this step is a bit more explicit.</li>
<li>Under the hood, messages are "addressed" using the app's UUID. At both ends, the apps need to use the same UUID.</li>
<li>If a message is sent to the watch and the corresponding app is not in the foreground, the message will get rejected by the OS.</li>
</ul>
<h3>Enabling AppMessage in a watch app</h3>
<ul>
<li>Parameters are contained within the <code>.messaging_info</code> struct in the <a class="el" href="group___app.html#struct_pebble_app_handlers" title="A collection of event handlers that your app can implement. See App for a code example. ">PebbleAppHandlers</a>.</li>
<li>Set buffer sizes. The AppMessage subsystem keeps 2 buffers, one for inbound messages (phone to watch) and one for outbound messages (watch to phone). The <a class="el" href="group___dictionary.html">Dictionary</a> serialization format is used for the messages. Use <a class="el" href="group___dictionary.html#ga8e85252a0649e731904a5288edd21ac9">dict_calc_buffer_size_from_tuplets()</a> or <a class="el" href="group___dictionary.html#ga0551d069624fb5bfc066fecfa4153bde">dict_calc_buffer_size()</a> to calculate the size of the largest message payloads for your application. <br/>
Add inbound and outbound buffer sizes to the fields in <code>.messaging_info.buffer_sizes</code> of your watch app's <a class="el" href="group___app.html#struct_pebble_app_handlers">PebbleAppHandlers</a>, for example: <div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> s_main(<span class="keywordtype">void</span> *params) {</div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="group___app.html#struct_pebble_app_handlers" title="A collection of event handlers that your app can implement. See App for a code example. ">PebbleAppHandlers</a> s_handlers = {</div>
<div class="line">    ...</div>
<div class="line">    .<a class="code" href="group___app.html#afb65506f881a65b34e98fd6a247d1431" title="Watch-phone app communication info. ">messaging_info</a> = {</div>
<div class="line">      .<a class="code" href="group___app.html#a64a446608ebfc1d6a2eeb2120521b029">buffer_sizes</a> = {</div>
<div class="line">        .<a class="code" href="group___app.html#a0b3a04cb06b6816ac1ea2623157fd098">inbound</a> = 64, <span class="comment">// inbound buffer size in bytes</span></div>
<div class="line">        .outbound = 16, <span class="comment">// outbound buffer size in bytes</span></div>
<div class="line">      },</div>
<div class="line">    },</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group___app.html#ga58e8145200447f94a0bdfff88495ec11" title="Default boilerplate event loop for apps, to be used in app&#39;s main() ">app_event_loop</a>(params, &amp;s_handlers);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Either use the <code>.messaging_info.default_callbacks</code> <a class="el" href="group___app_message.html#struct_app_message_callbacks_node" title="A node containing AppMessage callbacks and its context. In order to use the AppMessage subsystem...">AppMessageCallbacksNode</a> of your app's <a class="el" href="group___app.html#struct_pebble_app_handlers" title="A collection of event handlers that your app can implement. See App for a code example. ">PebbleAppHandlers</a>: <div class="fragment"><div class="line"><span class="keywordtype">void</span> my_out_sent_handler(<a class="code" href="group___dictionary.html#struct_dictionary_iterator" title="An iterator can be used to iterate over the key/value tuples in an existing dictionary, using dict_read_begin_from_buffer(), dict_read_first() and dict_read_next(). An iterator can also be used to append key/value tuples to a dictionary, for example using dict_write_data() or dict_write_cstring(). ">DictionaryIterator</a> *sent, <span class="keywordtype">void</span> *context) {</div>
<div class="line">  <span class="comment">// outgoing message was delivered</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> my_out_fail_handler(<a class="code" href="group___dictionary.html#struct_dictionary_iterator" title="An iterator can be used to iterate over the key/value tuples in an existing dictionary, using dict_read_begin_from_buffer(), dict_read_first() and dict_read_next(). An iterator can also be used to append key/value tuples to a dictionary, for example using dict_write_data() or dict_write_cstring(). ">DictionaryIterator</a> *failed, <a class="code" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e" title="AppMessage result codes. ">AppMessageResult</a> reason, <span class="keywordtype">void</span> *context) {</div>
<div class="line">  <span class="comment">// outgoing message failed</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> my_in_rcv_handler(<a class="code" href="group___dictionary.html#struct_dictionary_iterator" title="An iterator can be used to iterate over the key/value tuples in an existing dictionary, using dict_read_begin_from_buffer(), dict_read_first() and dict_read_next(). An iterator can also be used to append key/value tuples to a dictionary, for example using dict_write_data() or dict_write_cstring(). ">DictionaryIterator</a> *received, <span class="keywordtype">void</span> *context) {</div>
<div class="line">  <span class="comment">// incoming message received</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> my_in_drp_handler(<span class="keywordtype">void</span> *context, <a class="code" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e" title="AppMessage result codes. ">AppMessageResult</a> reason) {</div>
<div class="line">  <span class="comment">// incoming message dropped</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> s_main(<span class="keywordtype">void</span> *params) {</div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="group___app.html#struct_pebble_app_handlers" title="A collection of event handlers that your app can implement. See App for a code example. ">PebbleAppHandlers</a> s_handlers = {</div>
<div class="line">    ...</div>
<div class="line">    .<a class="code" href="group___app.html#afb65506f881a65b34e98fd6a247d1431" title="Watch-phone app communication info. ">messaging_info</a> = {</div>
<div class="line">      ...</div>
<div class="line">      .<a class="code" href="group___app.html#af5526ccbbd57677909240e09a2530656">default_callbacks</a>.<a class="code" href="group___app_message.html#aa274b8e9115c0a41a68dd74a8b373015" title="The app-callbacks. These are guaranteed to get called on the app-task. ">callbacks</a> = {</div>
<div class="line">        .<a class="code" href="struct_app_message_callbacks.html#a7b04ec9ef09ff02603ee1c239bce80f5" title="Called after an outgoing message is sent and acknowledged by the other end. ">out_sent</a> = my_out_sent_handler,</div>
<div class="line">        .out_failed = my_out_fail_handler,</div>
<div class="line">        .in_received = my_in_rcv_handler,</div>
<div class="line">        .in_dropped = my_in_drp_handler,</div>
<div class="line">      },</div>
<div class="line">    },</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group___app.html#ga58e8145200447f94a0bdfff88495ec11" title="Default boilerplate event loop for apps, to be used in app&#39;s main() ">app_event_loop</a>(params, &amp;s_handlers);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Or use the <a class="el" href="group___app_sync.html">AppSync</a> data synchronization layer.</li>
</ul>
<h3>Sending messages to the phone</h3>
<ul>
<li>Implement the <code>.out_sent</code> and <code>.out_failed</code> callbacks.</li>
<li>Use <a class="el" href="group___app_message.html#gaf04850d2ef214cbf081122789f8c77a7">app_message_out_get()</a> to get the <a class="el" href="group___dictionary.html#struct_dictionary_iterator">DictionaryIterator</a> for the outgoing message.</li>
<li>Write key/value pair to it using <a class="el" href="group___dictionary.html">Dictionary</a> functions, like <a class="el" href="group___dictionary.html#ga5ed3421ff8e8deda77545aae7d63f191">dict_write_tuplet()</a> and the like.</li>
<li>Send the message using <a class="el" href="group___app_message.html#ga4ef091f019ebdc013f8442a6f344612b">app_message_out_send()</a> and release ownership of the outgoing buffer using <a class="el" href="group___app_message.html#gac37c3fa563080ffcffce2f215b2f0796">app_message_out_release()</a>.</li>
<li>Once the acknowledgment has been received from the phone, the <code>.out_sent</code> callback will get called. If the message failed to get send or was rejected, the <code>.out_failed</code> callback will get called. See <a class="el" href="group___app.html#struct_pebble_app_handlers">PebbleAppHandlers</a> and <a class="el" href="group___app_message.html#gaba45cab5f6d9f5911950e3e9a68b1c63">app_message_register_callbacks()</a>.</li>
</ul>
<h3>Receiving messages from the phone</h3>
<ul>
<li>Implement the <code>.in_received</code> and <code>.in_dropped</code> callbacks.</li>
<li>When the phone sends a message to your app, normally, the <code>.in_received</code> callback is called. Pebble OS will acknowledge the message.</li>
<li>If the app is busy, the buffers are too small, the <code>.in_dropped</code> callback is called. Pebble OS will 'NACK' the message.</li>
<li>If the app is not running at all, the message will be discarded. Pebble OS will 'NACK' the message. <div class="image">
<img src="app_message.png" alt="app_message.png"/>
</div>
</li>
</ul>
<h3>Example Project</h3>
<p>For a code example, see the sample project <code>demos/feature_app_messages</code>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___app_sync.html">AppSync</a> </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga1a11eccfa2cf2b24a45c1186e25045e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_deregister_callbacks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___app_message.html#struct_app_message_callbacks_node">AppMessageCallbacksNode</a> *&#160;</td>
          <td class="paramname"><em>callbacks_node</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>De-registers a currently registered callback node with the app_message subsystem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks_node</td><td>Pointer to the datastructure containing the registered callbacks and context. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc">APP_MSG_OK</a> or <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eaf423093b0f84bca4495e227bdcd207bd">APP_MSG_CALLBACK_NOT_REGISTERED</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks_node</td><td>Pointer to the datastructure containing the callbacks and context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf04850d2ef214cbf081122789f8c77a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_out_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___dictionary.html#struct_dictionary_iterator">DictionaryIterator</a> **&#160;</td>
          <td class="paramname"><em>iter_out</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attempts to "take" the writable, outbound dictionary resource. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">iter_out</td><td>Pointer to a <a class="el" href="group___dictionary.html#struct_dictionary_iterator" title="An iterator can be used to iterate over the key/value tuples in an existing dictionary, using dict_read_begin_from_buffer(), dict_read_first() and dict_read_next(). An iterator can also be used to append key/value tuples to a dictionary, for example using dict_write_data() or dict_write_cstring(). ">DictionaryIterator</a> pointer. When this call returns successfully, the pointer has been set to a valid <a class="el" href="group___dictionary.html#struct_dictionary_iterator" title="An iterator can be used to iterate over the key/value tuples in an existing dictionary, using dict_read_begin_from_buffer(), dict_read_first() and dict_read_next(). An iterator can also be used to append key/value tuples to a dictionary, for example using dict_write_data() or dict_write_cstring(). ">DictionaryIterator</a>, set up for writing into the outbound buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc">APP_MSG_OK</a>, <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eadfb91bdd9c369cc2eb00e019b4cf3846">APP_MSG_INVALID_ARGS</a> or <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29eaad6af2baa488efedd56b17f0ed1e8339">APP_MSG_BUSY</a> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>After a successful call, one can add values to the dictionary using functions like <a class="el" href="group___dictionary.html#ga30091feef740732d5d6bc3cf2312642a">dict_write_data()</a> and friends. </dd>
<dd>
A call to this function MUST be balanced with a call to <a class="el" href="group___app_message.html#gac37c3fa563080ffcffce2f215b2f0796">app_message_out_release()</a>. </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___dictionary.html">Dictionary</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gac37c3fa563080ffcffce2f215b2f0796"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_out_release </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the outbound dictionary resource. After having taking the outbound resource, it must be "released" at some later point in time, so other subsystems can access it again. </p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc">APP_MSG_OK</a> or <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea9ea88c5f059e1aee4010fee576d766bd">APP_MSG_ALREADY_RELEASED</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga4ef091f019ebdc013f8442a6f344612b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_out_send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the outbound dictionary. </p>
<dl class="section note"><dt>Note</dt><dd>It is fine to call <a class="el" href="group___app_message.html#ga4ef091f019ebdc013f8442a6f344612b">app_message_out_send()</a> before releasing the resource with <a class="el" href="group___app_message.html#gac37c3fa563080ffcffce2f215b2f0796">app_message_out_release()</a>. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>APP_MSG_OK or APP_MSG_BUSY </dd></dl>

</div>
</div>
<a class="anchor" id="gaba45cab5f6d9f5911950e3e9a68b1c63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a> app_message_register_callbacks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___app_message.html#struct_app_message_callbacks_node">AppMessageCallbacksNode</a> *&#160;</td>
          <td class="paramname"><em>callbacks_node</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a callback node with the app_message subsystem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks_node</td><td>Pointer to the datastructure containing the callbacks and context. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc">APP_MSG_OK</a> or <a class="el" href="group___app_message.html#gga695a78c926b20edbb14d7faf5a78c29ea1655968e4f04aa0b357acc4605dcff64">APP_MSG_CALLBACK_ALREADY_REGISTERED</a> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The caller needs to make sure that <code>callbacks_node</code> remains alive, at least until <a class="el" href="group___app_message.html#ga1a11eccfa2cf2b24a45c1186e25045e7" title="De-registers a currently registered callback node with the app_message subsystem. ...">app_message_deregister_callbacks()</a> is called with that same node. </dd></dl>

</div>
</div>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="struct_app_message_callbacks_node" id="struct_app_message_callbacks_node"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct AppMessageCallbacksNode</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A node containing AppMessage callbacks and its context. In order to use the AppMessage subsystem, apps can use the default callback node in the app's <a class="el" href="group___app.html#struct_pebble_app_handlers">PebbleAppHandlers</a>, but they can also register additional callbacks nodes using <a class="el" href="group___app_message.html#gaba45cab5f6d9f5911950e3e9a68b1c63">app_message_register_callbacks()</a>. The storage of this data structure needs to be long-lived and cannot be stack-allocated. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___app_message.html#ga1a11eccfa2cf2b24a45c1186e25045e7">app_message_deregister_callbacks()</a> </dd></dl>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aa274b8e9115c0a41a68dd74a8b373015"></a><a class="el" href="struct_app_message_callbacks.html">AppMessageCallbacks</a></td>
<td class="fieldname">
callbacks</td>
<td class="fielddoc">
The app-callbacks. These are guaranteed to get called on the app-task. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a9ec1f516f45bb478aaca63d38822e0b5"></a>void *</td>
<td class="fieldname">
context</td>
<td class="fielddoc">
The context. A pointer to app-specific data, that is passed into the callbacks. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ac24527f81759bb524b09805308a3de94"></a>ListNode</td>
<td class="fieldname">
node</td>
<td class="fielddoc">
The list node that is used by AppMessage internally. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga695a78c926b20edbb14d7faf5a78c29e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___app_message.html#ga695a78c926b20edbb14d7faf5a78c29e">AppMessageResult</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AppMessage result codes. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea12a6ea49b151222e76cf4b99b7c0c4cc"></a>APP_MSG_OK</em>&nbsp;</td><td class="fielddoc">
<p>All good, operation was successful. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea4a03bcc21fc33a6acc7d73188b2b4b21"></a>APP_MSG_SEND_TIMEOUT</em>&nbsp;</td><td class="fielddoc">
<p>The other end did not confirm receiving the sent data with an (n)ack in time. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eadba700a7db67d4238d24e7379b69fba3"></a>APP_MSG_SEND_REJECTED</em>&nbsp;</td><td class="fielddoc">
<p>The other end rejected the sent data, with a "nack" reply. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea8dda18d5302ef6b07aa83985e91b54b7"></a>APP_MSG_NOT_CONNECTED</em>&nbsp;</td><td class="fielddoc">
<p>The other end was not connected. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea38e78da25eed665c85368df213ed8088"></a>APP_MSG_APP_NOT_RUNNING</em>&nbsp;</td><td class="fielddoc">
<p>The local application was not running. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eadfb91bdd9c369cc2eb00e019b4cf3846"></a>APP_MSG_INVALID_ARGS</em>&nbsp;</td><td class="fielddoc">
<p>The function was called with invalid arguments. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eaad6af2baa488efedd56b17f0ed1e8339"></a>APP_MSG_BUSY</em>&nbsp;</td><td class="fielddoc">
<p>There are pending (in or outbound) messages that need to be processed first before new ones can be received or sent. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eaf2eb603be26c295d0a16433564a72598"></a>APP_MSG_BUFFER_OVERFLOW</em>&nbsp;</td><td class="fielddoc">
<p>The buffer was too small to contain the incoming message. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea9ea88c5f059e1aee4010fee576d766bd"></a>APP_MSG_ALREADY_RELEASED</em>&nbsp;</td><td class="fielddoc">
<p>The resource had already been released. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29ea1655968e4f04aa0b357acc4605dcff64"></a>APP_MSG_CALLBACK_ALREADY_REGISTERED</em>&nbsp;</td><td class="fielddoc">
<p>The callback node was already registered, or its ListNode has not been initialized. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga695a78c926b20edbb14d7faf5a78c29eaf423093b0f84bca4495e227bdcd207bd"></a>APP_MSG_CALLBACK_NOT_REGISTERED</em>&nbsp;</td><td class="fielddoc">
<p>The callback could not be deregistered, because it had not been registered before. </p>
</td></tr>
</table>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jul 3 2013 18:58:58 for Pebble SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
